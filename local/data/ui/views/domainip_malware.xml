<view autoCancelInterval="90" isVisible="true" onunloadCancelJobs="true" template="dashboard.html" >
  <!--  autoCancelInterval is set here to 100  -->
  <label>DomainIP: By Malware</label>
  <module name="AccountBar" layoutPanel="appHeader"/>
  <module name="AppBar" layoutPanel="navigationHeader"/>
  <module name="Message" layoutPanel="messaging">
    <param name="filter">*</param>
    <param name="clearOnJobDispatch">False</param>
    <param name="maxSize">1</param>
  </module>
  
  <module name="TimeRangePicker" layoutPanel="panel_row2_col1" autorun="True">
    <module name="StaticContentSample" layoutPanel="panel_row2_col1" >
      <param name="text">
        <![CDATA[ This forced-based attack graph shows the comprehensive malicious hostname and resolved IPs relationships.   
	Central red dot: the circle means cuckoo reports.
	Green dot: Malware samples MD5
	Black dot: Malcious hostname extracting from cuckoo reports
	Dark red dot: Resolved IPs or fast-flux IPs by ffdomain external module
        
	The most important we did in this graph is to make nodes unique. It helps us easily find the "weak point" which is controlled under more malware samples or mapping to more resolved IPs. 
	]]>
      </param>
    </module>
    <param name="selected">Last 24 hours</param>
    <param name="searchWhenChanged">true</param>
    
    <module name="HiddenSearch" layoutPanel="panel_row3_col1" group="Force-connected graph: Malware-Maliciou Hostname-Resolved IPs" autoRun="True">
     <param name="search">index=cuckoo_dnsinfo | geoip dnsinfo_ip | strcat dnsinfo_hostname &quot;@&quot; dnsinfo_ip &quot;@&quot; dnsinfo_ip_country_code dnsinfo | stats values(dnsinfo_hostname) as hostname, values(dnsinfo) as dnsinfo  by md5</param>
     <module name="domainip"></module>
    </module>

    
    <module name="HiddenSearch" layoutPanel="panel_row4_col1" autoRun="True" group="Malware lists with malicious hostname and resolved IPs">
      <param name="search">index =thug_files_logs
      | convert timeformat="%D %H:%M:%S" ctime(_time) AS timestamp
      | JOIN type=left md5 [ SEARCH index="cuckoo_dnsinfo" ]
      | stats count(md5) as "Count" , first(timestamp) as "Last Seen", values(url) as Url-to-collect-malware, values(dnsinfo_hostname) as Mal-domain by md5
      | rename md5 as Malware | sort - first(timestamp)
      </param>
      <module name="ResultsHeader" layoutPanel="panel_row4_col1">
        <param name="entityLabel">results</param>
        <param name="entityName">results</param>
        <module name="Paginator">
          <param name="count">6</param>
          <param name="entityName">results</param>
          <param name="maxPages">10</param>
          <module name="SimpleResultsTable">
            <param name="drilldown">all</param>
            <param name="entityName">results</param>
            <module name="ConvertToDrilldownSearch">
              
              
              <module name="Paginator">
                <param name="count">6</param>
                <param name="entityName">events</param>
                <param name="maxPages">10</param>
                <module name="JobProgressIndicator"></module>
                <module name="SimpleResultsHeader">
                  <param name="entityName">events</param>
                  <param name="headerFormat">$time$ : Found $count$ events </param>
                </module>
                <module name="EventsViewer" >
                  <param name="segmentation">inner</param>
                  <param name="count">6</param>
                  <param name="reportFieldLink">report_builder_format_report</param>
                  <param name="maxLines">4</param>
                  <param name="entityName">results_preview</param>
                </module>
              </module>
            </module>
          </module>
        </module>
      </module>
    </module>
  </module>
</view>
